# üß™ GU√çA DE PRUEBAS FUNCIONALES PASO A PASO
**Para verificar que TODO funciona correctamente**

---

## üìã √çNDICE DE PRUEBAS

1. [Prueba: Configurar Vacaciones](#prueba-1-configurar-vacaciones)
2. [Prueba: Cambiar Horario de Almuerzo](#prueba-2-cambiar-horario-de-almuerzo)
3. [Prueba: Crear Anuncio que Bloquea Reservas](#prueba-3-crear-anuncio-que-bloquea-reservas)
4. [Prueba: Overlap entre Servicios Diferentes](#prueba-4-overlap-entre-servicios-diferentes)
5. [Verificaci√≥n Completa del Sistema](#verificacion-completa)

---

## üß™ PRUEBA #1: Configurar Vacaciones

### Objetivo
Verificar que cuando Lorena configura vacaciones, los clientes NO pueden sacar turnos en esas fechas.

### Paso a Paso

#### 1. Login como Admin
- Ir a `/admin/login`
- Email: `admin@esteticaintegral.com.ar`
- Password: tu contrase√±a
- Click "Iniciar Sesi√≥n"

#### 2. Ir a Pesta√±a "Cierres / Vacaciones"
- Click en la pesta√±a "Cierres / Vacaciones"

#### 3. Crear un Cierre
En el formulario:
- **Tipo de cierre:** Vacaciones
- **Fecha inicio:** Elige una fecha futura (ej: 25/10/2025)
- **Fecha fin:** 2-3 d√≠as despu√©s (ej: 27/10/2025)
- **Motivo:** "Vacaciones de prueba"
- Click en **"Crear"**

#### 4. Verificar que se Cre√≥
- Deber√≠as ver el cierre en la lista
- Con badge azul "Vacaciones"
- Fechas correctas

#### 5. Probar como Cliente
- **Cerrar sesi√≥n** del admin
- Ir a la p√°gina principal `/`
- Click en cualquier servicio (ej: Limpieza Facial)
- Click en "Reservar Turno"
- **Seleccionar una de las fechas de vacaciones** (25, 26 o 27 de octubre)

**‚úÖ RESULTADO ESPERADO:**
- NO debe mostrar horarios disponibles
- Debe mostrar mensaje: **"No hay atenci√≥n disponible: Vacaciones de prueba"**

**‚ùå SI NO FUNCIONA:**
- Verifica que el cierre est√© marcado como "Activo"
- Verifica las fechas seleccionadas

#### 6. Desactivar el Cierre
- Volver al admin
- En la lista de cierres, click en **"Desactivar"**

#### 7. Verificar que Ahora S√ç Aparecen Horarios
- Como cliente, recargar la p√°gina
- Seleccionar la misma fecha
- **Ahora S√ç deben aparecer horarios disponibles** ‚úÖ

---

## üß™ PRUEBA #2: Cambiar Horario de Almuerzo

### Objetivo
Verificar que al cambiar el horario de almuerzo, los clientes NO pueden reservar en ese horario.

### Paso a Paso

#### 1. Ir a Pesta√±a "Horarios"
- Login como admin
- Click en "Horarios"

#### 2. Editar Horario de un D√≠a
- Buscar "Lunes" en la lista
- Click en **"Editar"** (icono de l√°piz)

#### 3. Cambiar Horario de Almuerzo
- **Almuerzo inicio:** Cambia de `13:00` a `14:00`
- **Almuerzo fin:** Cambia de `14:00` a `15:00`
- Click en **"Actualizar"**

#### 4. Verificar como Cliente
- Cerrar sesi√≥n
- Ir a reservar turno
- Seleccionar **pr√≥ximo lunes**
- Seleccionar un servicio de 45 minutos

**‚úÖ RESULTADO ESPERADO:**
- Horarios disponibles: 9:00, 9:45, 10:30, 11:15, 12:00, 12:45, 13:00, 13:15
- **NO debe aparecer:** 14:00, 14:15, 14:30, 14:45 (horario de almuerzo)
- Horarios despu√©s del almuerzo: 15:00, 15:45, 16:30, 17:15

#### 5. Volver a Configuraci√≥n Original
- Editar nuevamente
- Almuerzo inicio: `13:00`
- Almuerzo fin: `14:00`
- Actualizar

---

## üß™ PRUEBA #3: Crear Anuncio que Bloquea Reservas

### Objetivo
Verificar que los anuncios con "Bloquear reservas" impiden que los clientes reserven.

### Paso a Paso

#### 1. Ir a Pesta√±a "Anuncios"
- Login como admin
- Click en "Anuncios"

#### 2. Crear Anuncio
- **Tipo:** Alerta
- **T√≠tulo:** "Mantenimiento del Sistema"
- **Mensaje:** "Estamos realizando mantenimiento. Las reservas online estar√°n suspendidas temporalmente."
- ‚úÖ **Mostrar en p√°gina principal:** Activado
- ‚úÖ **Bloquear reservas:** Activado
- Click en **"Crear"**

#### 3. Verificar en Home
- Ir a la p√°gina principal `/`
- **Deber√≠as ver un banner rojo** en la parte superior con el mensaje

#### 4. Intentar Reservar
- Click en cualquier servicio
- Click en "Reservar Turno"

**‚úÖ RESULTADO ESPERADO:**
- Debe mostrar mensaje de error
- **NO debe permitir seleccionar fecha/hora**
- Bot√≥n "Reservar Turno" debe estar deshabilitado

#### 5. Desactivar el Anuncio
- Volver al admin
- En la lista de anuncios, click en **icono de ojo** (Desactivar)

#### 6. Verificar que Ahora S√ç Funciona
- Como cliente, recargar
- **Ahora S√ç debe permitir reservar** ‚úÖ

---

## üß™ PRUEBA #4: Overlap entre Servicios Diferentes

### Objetivo
Verificar que Lorena NO puede tener 2 pacientes al mismo tiempo, incluso con servicios diferentes.

### Paso a Paso

#### 1. Reservar Primera Cita (Depilaci√≥n L√°ser)
- Como cliente, seleccionar **"Depilaci√≥n L√°ser"** (20 min)
- Seleccionar fecha: **ma√±ana**
- Seleccionar hora: **15:00**
- Completar datos y confirmar

**Cita creada:** 15:00 - 15:20 (Depilaci√≥n L√°ser)

#### 2. Abrir en OTRO Navegador
- Abrir Firefox/Edge (diferente al que usaste)
- Ir a la p√°gina principal

#### 3. Intentar Reservar Otra Cita (Sonoterapia)
- Seleccionar **"Sonoterapia"** (45 min)
- Seleccionar la **misma fecha** (ma√±ana)
- Ver los horarios disponibles

**‚úÖ RESULTADO ESPERADO:**
```
Horarios que NO deben aparecer:
‚ùå 14:20 (terminar√≠a a las 15:05 - overlap con depilaci√≥n)
‚ùå 14:35 (terminar√≠a a las 15:20 - overlap)
‚ùå 14:50 (terminar√≠a a las 15:35 - overlap)
‚ùå 15:00 (empezar√≠a cuando ya hay cita - overlap)

Horarios que S√ç deben aparecer:
‚úÖ 14:00 (termina 14:45 - antes de la depilaci√≥n)
‚úÖ 15:20 (empieza despu√©s de la depilaci√≥n)
‚úÖ 16:00, 16:45, etc.
```

**Esto confirma:** Lorena NO puede tener 2 pacientes al mismo tiempo ‚úÖ

#### 4. Limpiar Prueba
- Como admin, cancelar o eliminar la cita de prueba

---

## üß™ PRUEBA #5: Cierres con Turnos Programados

### Objetivo
Verificar que el sistema AVISA si hay turnos programados antes de crear un cierre.

### Paso a Paso

#### 1. Crear una Cita Futura
- Como admin, crear cita para el **30/10/2025** a las **10:00**
- Puede ser cualquier servicio

#### 2. Intentar Crear Cierre para Esa Fecha
- Ir a "Cierres / Vacaciones"
- Fecha inicio: **29/10/2025**
- Fecha fin: **31/10/2025**
- Click en "Crear"

**‚úÖ RESULTADO ESPERADO:**
- **Error en rojo**
- Mensaje: "Hay 1 turno(s) programado(s) en este periodo"
- **Lista de turnos en conflicto:**
  - 30/10/2025 a las 10:00 - [Nombre del paciente]
- **NO debe crear el cierre**

#### 3. Cancelar el Turno
- Ir a "Turnos"
- Buscar el turno del 30/10
- Marcarlo como "Cancelado"

#### 4. Intentar Crear Cierre Nuevamente
- Mismas fechas
- Click en "Crear"

**‚úÖ RESULTADO ESPERADO:**
- **Ahora S√ç debe crear el cierre** ‚úÖ
- Sin errores

---

## üß™ PRUEBA #6: Modificar Horario de Almuerzo Afecta Disponibilidad

### Escenario Completo

#### Configuraci√≥n Inicial
- Lunes: 9:00 - 18:00, Almuerzo: 13:00 - 14:00

#### Prueba 1: Horarios Disponibles Actuales
- Como cliente, reservar para pr√≥ximo lunes
- Servicio de 45 min
- **Verificar que NO aparezca:** 13:00, 13:15, 13:30, 13:45

#### Prueba 2: Cambiar Almuerzo
- Como admin, editar horario de lunes
- Almuerzo: 12:00 - 13:00 (cambiar)
- Guardar

#### Prueba 3: Verificar Cambio
- Como cliente, recargar
- Seleccionar pr√≥ximo lunes
- **Ahora NO debe aparecer:** 12:00, 12:15, 12:30, 12:45
- **Ahora S√ç debe aparecer:** 13:00, 13:45, 14:30

**‚úÖ Esto confirma:** Los cambios de horario se aplican inmediatamente

---

## ‚úÖ VERIFICACI√ìN COMPLETA DEL SISTEMA

### Checklist Final

Ejecuta todas estas pruebas y marca las que funcionen:

#### Gesti√≥n de Cierres/Vacaciones
- [ ] Puedes crear un cierre
- [ ] Los clientes NO pueden reservar en fechas cerradas
- [ ] Aparece mensaje con el motivo del cierre
- [ ] Sistema avisa si hay turnos programados
- [ ] Puedes activar/desactivar cierres
- [ ] Puedes editar cierres existentes
- [ ] Puedes eliminar cierres

#### Gesti√≥n de Horarios
- [ ] Puedes cambiar horario de inicio/fin
- [ ] Puedes cambiar horario de almuerzo
- [ ] Los cambios se reflejan inmediatamente en disponibilidad
- [ ] Horarios de almuerzo NO aparecen disponibles
- [ ] Puedes activar/desactivar d√≠as
- [ ] Puedes editar horarios existentes

#### Gesti√≥n de Anuncios
- [ ] Puedes crear un anuncio
- [ ] El anuncio aparece en la home
- [ ] Opci√≥n "Bloquear reservas" funciona
- [ ] Cuando est√° bloqueado, NO se puede reservar
- [ ] Puedes activar/desactivar anuncios
- [ ] Puedes editar anuncios
- [ ] Puedes eliminar anuncios

#### Validaci√≥n de Overlap
- [ ] NO se puede reservar mismo horario para 2 servicios diferentes
- [ ] Sistema considera la duraci√≥n completa del servicio
- [ ] Funciona tanto en reserva p√∫blica como en admin
- [ ] Mensaje de error es claro

---

## üîß SI ALGO NO FUNCIONA

### Problema: Cierre no bloquea reservas

**Verificar:**
1. El cierre est√° marcado como "Activo" (toggle verde)
2. Las fechas est√°n correctas
3. Recargar la p√°gina del cliente (F5)

### Problema: Horario de almuerzo aparece disponible

**Verificar:**
1. El horario tiene lunch_start y lunch_end configurados
2. El horario est√° marcado como "Activo"
3. Las horas no tienen formato incorrecto

### Problema: Anuncio no bloquea reservas

**Verificar:**
1. Checkbox "Bloquear reservas" est√° activado
2. El anuncio est√° marcado como "Activo"
3. En el c√≥digo de AppointmentBooking.tsx hay verificaci√≥n

### Problema: Se pueden reservar 2 servicios al mismo tiempo

**Esto ser√≠a un bug serio. Verificar:**
1. Query obtiene TODAS las citas del d√≠a (sin filtrar por servicio)
2. C√°lculo de overlap est√° correcto
3. Logs en consola del navegador (F12)

---

## üìä TABLA DE RESULTADOS

Completa esta tabla despu√©s de hacer las pruebas:

| Prueba | Resultado | Notas |
|--------|-----------|-------|
| Crear cierre de vacaciones | ‚¨ú Funciona / ‚¨ú Falla | |
| Clientes no pueden reservar en fechas cerradas | ‚¨ú Funciona / ‚¨ú Falla | |
| Sistema avisa de turnos programados | ‚¨ú Funciona / ‚¨ú Falla | |
| Cambiar horario de almuerzo | ‚¨ú Funciona / ‚¨ú Falla | |
| Almuerzo no aparece disponible | ‚¨ú Funciona / ‚¨ú Falla | |
| Crear anuncio que bloquea | ‚¨ú Funciona / ‚¨ú Falla | |
| Anuncio impide reservas | ‚¨ú Funciona / ‚¨ú Falla | |
| Overlap entre servicios diferentes | ‚¨ú Funciona / ‚¨ú Falla | |

---

## üéØ ESCENARIOS CR√çTICOS A PROBAR

### Escenario Real #1: Vacaciones de Verano

**Situaci√≥n:**
- Lorena se va de vacaciones del 20/12 al 05/01
- Ya hay 3 turnos programados para el 22/12

**Prueba:**
1. Intentar crear cierre 20/12 - 05/01
2. **Debe mostrar error** con los 3 turnos
3. Cancelar los 3 turnos
4. Intentar crear cierre nuevamente
5. **Ahora debe funcionar** ‚úÖ
6. Cliente intenta reservar para 25/12
7. **Debe mostrar:** "No hay atenci√≥n disponible: Vacaciones de verano"

---

### Escenario Real #2: Cambio de Horario de Almuerzo

**Situaci√≥n:**
- Lorena decide almorzar m√°s tarde: 14:00-15:00 en lugar de 13:00-14:00

**Prueba:**
1. Admin edita horario de Lunes a Viernes
2. Almuerzo: 14:00 - 15:00
3. Guardar
4. Cliente reserva para el martes
5. **Debe ver disponible:** 13:00, 13:45 (antes no estaban)
6. **NO debe ver:** 14:00, 14:45 (ahora es almuerzo)

---

### Escenario Real #3: Mantenimiento de Emergencia

**Situaci√≥n:**
- Se rompi√≥ un equipo, necesita cerrar 2 d√≠as

**Prueba:**
1. Admin crea anuncio:
   - Tipo: Alerta
   - T√≠tulo: "Mantenimiento de Emergencia"
   - Mensaje: "Equipo en reparaci√≥n. Volvemos el viernes."
   - ‚úÖ Bloquear reservas
   - Fechas: Hoy - Pasado ma√±ana
2. **Clientes ven el mensaje** en home
3. **NO pueden hacer nuevas reservas**
4. Admin puede seguir viendo/editando turnos existentes
5. Cuando termina el mantenimiento ‚Üí Desactivar anuncio
6. **Reservas vuelven a funcionar** ‚úÖ

---

### Escenario Real #4: D√≠a Completo

**Situaci√≥n:**
- Lorena tiene agenda llena el mi√©rcoles
- Quiere ver que NO haya m√°s reservas

**Prueba:**
1. Admin crea 10 citas para el mi√©rcoles
2. Llenar horarios de 9:00 a 17:00
3. Cliente intenta reservar para ese mi√©rcoles
4. **Debe mostrar:** "No hay horarios disponibles"
5. Admin cancela 1 cita de las 11:00
6. Cliente recarga
7. **Ahora debe aparecer:** 11:00 disponible ‚úÖ

---

## üîç PUNTOS CR√çTICOS A VERIFICAR

### 1. Validaci√≥n en M√∫ltiples Capas

**Frontend (Cliente):**
- Fechas cerradas no muestran horarios
- Horarios ocupados no aparecen
- Mensajes claros de error

**Backend (API):**
- Verifica disponibilidad antes de crear
- Verifica cierres antes de crear
- Constraint UNIQUE en BD previene duplicados

**Base de Datos:**
- UNIQUE constraint activo
- Triggers funcionando
- Policies RLS correctas

### 2. Mensajes al Usuario

**Cuando hay cierre:**
```
"No hay atenci√≥n disponible: [motivo del cierre]"
```

**Cuando hay overlap:**
```
"El horario seleccionado ya no est√° disponible"
```

**Cuando hay anuncio bloqueando:**
```
"Las reservas est√°n temporalmente suspendidas"
```

---

## üìã RESULTADO ESPERADO FINAL

Si **TODAS** las pruebas pasan:

‚úÖ Sistema de cierres funciona perfectamente  
‚úÖ Cambios de horario se aplican inmediatamente  
‚úÖ Anuncios con bloqueo funcionan  
‚úÖ Overlap previene citas simult√°neas  
‚úÖ **Tu sistema est√° 100% funcional para entregar** üéâ

---

## üêõ Reportar Problemas

Si algo **NO funciona**:

1. Anota qu√© prueba fall√≥
2. Toma screenshot del error
3. Revisa console del navegador (F12 > Console)
4. Revisa logs en terminal donde corre `npm run dev`

---

**üß™ Recomendaci√≥n:** Ejecuta todas estas pruebas antes de entregar a Lorena para estar 100% seguro de que todo funciona.

**Tiempo estimado:** 20-30 minutos para todas las pruebas

---

**√öltima actualizaci√≥n:** 20 de Octubre, 2025  
**Versi√≥n:** 1.0

